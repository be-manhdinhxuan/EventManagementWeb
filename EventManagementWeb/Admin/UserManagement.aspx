<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="UserManagement.aspx.cs" Inherits="EventManagementWeb.Admin.UserManagement" %>

<%@ Import Namespace="System.Data" %>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Quản lý nhân viên</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../Assets/css/style.css" rel="stylesheet" />
    <link href="../Assets/css/common-layout.css" rel="stylesheet" />
    <link href="../Assets/css/pages/user-management.css" rel="stylesheet" />
</head>
<body>
    <form id="form1" runat="server">
        <div class="parent">
            <!-- Sidebar -->
            <aside class="sidebar">
                <ul class="sidebar__nav">
                    <li class="sidebar__item">
                        <a href="Dashboard.aspx" class="sidebar__link ">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.3333 12V4H28V12H17.3333ZM4 17.3333V4H14.6667V17.3333H4ZM17.3333 28V14.6667H28V28H17.3333ZM4 28V20H14.6667V28H4Z" fill="currentColor" />
                            </svg>
                            <span>Dashboard</span>
                        </a>
                    </li>

                    <li class="sidebar__item">
                        <a href="EventManagement.aspx" class="sidebar__link ">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.33333 14.6668H12V17.3335H9.33333V14.6668ZM28 6.66683V25.3335C28 26.8135 26.8133 28.0002 25.3333 28.0002H6.66667C5.95942 28.0002 5.28115 27.7192 4.78105 27.2191C4.28095 26.719 4 26.0407 4 25.3335V6.66683C4 5.20016 5.2 4.00016 6.66667 4.00016H8V1.3335H10.6667V4.00016H21.3333V1.3335H24V4.00016H25.3333C26.0406 4.00016 26.7189 4.28111 27.219 4.78121C27.719 5.28131 28 5.95959 28 6.66683ZM6.66667 9.3335H25.3333V6.66683H6.66667V9.3335ZM25.3333 25.3335V12.0002H6.66667V25.3335H25.3333ZM20 17.3335H22.6667V14.6668H20V17.3335ZM14.6667 17.3335H17.3333V14.6668H14.6667V17.3335Z" fill="currentColor" />
                            </svg>
                            <span>Quản lý sự kiện</span>
                        </a>
                    </li>

                    <li class="sidebar__item">
                        <a href="UserManagement.aspx" class="sidebar__link sidebar__link--active">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.4267 13.8802C18.2366 12.7486 18.6721 11.3918 18.6721 10.0002C18.6721 8.60859 18.2366 7.25186 17.4267 6.12021C18.185 5.60359 19.0824 5.32928 20 5.33355C21.2377 5.33355 22.4247 5.82521 23.2998 6.70038C24.175 7.57555 24.6667 8.76253 24.6667 10.0002C24.6667 11.2379 24.175 12.4249 23.2998 13.3C22.4247 14.1752 21.2377 14.6669 20 14.6669C19.0824 14.6711 18.185 14.3968 17.4267 13.8802ZM7.33332 10.0002C7.33332 9.07723 7.60702 8.17498 8.1198 7.40755C8.63258 6.64012 9.36141 6.04198 10.2141 5.68877C11.0669 5.33557 12.0052 5.24315 12.9104 5.42321C13.8157 5.60328 14.6472 6.04774 15.2998 6.70038C15.9525 7.35303 16.3969 8.18455 16.577 9.08979C16.7571 9.99504 16.6646 10.9333 16.3114 11.7861C15.9582 12.6388 15.3601 13.3676 14.5927 13.8804C13.8252 14.3932 12.923 14.6669 12 14.6669C10.7623 14.6669 9.57533 14.1752 8.70016 13.3C7.82499 12.4249 7.33332 11.2379 7.33332 10.0002ZM9.99999 10.0002C9.99999 10.3958 10.1173 10.7825 10.3371 11.1114C10.5568 11.4402 10.8692 11.6966 11.2346 11.848C11.6001 11.9993 12.0022 12.039 12.3902 11.9618C12.7781 11.8846 13.1345 11.6941 13.4142 11.4144C13.6939 11.1347 13.8844 10.7784 13.9616 10.3904C14.0387 10.0024 13.9991 9.6003 13.8477 9.23484C13.6964 8.86939 13.44 8.55704 13.1111 8.33727C12.7822 8.11751 12.3956 8.00021 12 8.00021C11.4696 8.00021 10.9608 8.21093 10.5858 8.586C10.2107 8.96107 9.99999 9.46978 9.99999 10.0002ZM21.3333 22.6669V25.3335H2.66666V22.6669C2.66666 22.6669 2.66666 17.3335 12 17.3335C21.3333 17.3335 21.3333 22.6669 21.3333 22.6669ZM18.6667 22.6669C18.48 21.6269 16.8933 20.0002 12 20.0002C7.10666 20.0002 5.42666 21.7469 5.33332 22.6669M21.2667 17.3335C22.0839 17.9692 22.752 18.776 23.2242 19.6974C23.6964 20.6187 23.9612 21.6323 24 22.6669V25.3335H29.3333V22.6669C29.3333 22.6669 29.3333 17.8269 21.2533 17.3335H21.2667Z" fill="currentColor" />
                            </svg>
                            <span>Quản lý nhân viên</span>
                        </a>
                    </li>

                    <li class="sidebar__item">
                        <a href="Notification.aspx" class="sidebar__link">
                            <svg
                                width="32"
                                height="32"
                                viewBox="0 0 32 32"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    fill-rule="evenodd"
                                    clip-rule="evenodd"
                                    d="M6.66674 12C6.66674 9.52464 7.65007 7.15067 9.40041 5.40033C11.1507 3.64999 13.5247 2.66666 16.0001 2.66666C18.4754 2.66666 20.8494 3.64999 22.5997 5.40033C24.3501 7.15067 25.3334 9.52464 25.3334 12V17.0187L27.7627 21.8773C27.8746 22.101 27.9274 22.3495 27.9161 22.5992C27.9049 22.849 27.83 23.0918 27.6985 23.3044C27.5671 23.5171 27.3834 23.6927 27.165 23.8144C26.9467 23.9361 26.7008 24 26.4507 24H21.1654C20.8688 25.1443 20.2006 26.1578 19.2658 26.8812C18.3309 27.6047 17.1822 27.9972 16.0001 27.9972C14.8179 27.9972 13.6693 27.6047 12.7344 26.8812C11.7995 26.1578 11.1313 25.1443 10.8347 24H5.5494C5.29937 24 5.05349 23.9361 4.83509 23.8144C4.6167 23.6927 4.43305 23.5171 4.3016 23.3044C4.17014 23.0918 4.09524 22.849 4.084 22.5992C4.07277 22.3495 4.12557 22.101 4.2374 21.8773L6.66674 17.0187V12ZM13.6907 24C13.9248 24.4053 14.2614 24.742 14.6668 24.976C15.0722 25.21 15.532 25.3332 16.0001 25.3332C16.4681 25.3332 16.928 25.21 17.3333 24.976C17.7387 24.742 18.0753 24.4053 18.3094 24H13.6907ZM16.0001 5.33333C14.232 5.33333 12.5363 6.03571 11.286 7.28595C10.0358 8.53619 9.3334 10.2319 9.3334 12V17.0187C9.33337 17.4324 9.23706 17.8405 9.05207 18.2107L7.49207 21.3333H24.5094L22.9494 18.2107C22.764 17.8406 22.6672 17.4325 22.6667 17.0187V12C22.6667 10.2319 21.9644 8.53619 20.7141 7.28595C19.4639 6.03571 17.7682 5.33333 16.0001 5.33333Z"
                                    fill="currentColor" />
                            </svg>
                            <span>Thông báo</span>
                        </a>
                    </li>

                    <li class="sidebar__item">
                        <a href="Setting.aspx" class="sidebar__link">
                            <svg
                                width="32"
                                height="32"
                                viewBox="0 0 32 32"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M26.5335 16.88C26.3198 16.6367 26.2019 16.3239 26.2019 16C26.2019 15.6761 26.3198 15.3633 26.5335 15.12L28.2402 13.2C28.4282 12.9902 28.545 12.7263 28.5738 12.446C28.6025 12.1658 28.5417 11.8836 28.4002 11.64L25.7335 7.02667C25.5934 6.78336 25.38 6.5905 25.1239 6.47558C24.8677 6.36066 24.5818 6.32955 24.3069 6.38667L21.8002 6.89334C21.4812 6.95924 21.1492 6.90612 20.8667 6.744C20.5842 6.58188 20.3709 6.32198 20.2669 6.01334L19.4535 3.57334C19.3641 3.30851 19.1937 3.07849 18.9664 2.91579C18.7391 2.75309 18.4664 2.66595 18.1869 2.66667H12.8535C12.5628 2.65149 12.275 2.7319 12.0343 2.89562C11.7935 3.05934 11.613 3.29736 11.5202 3.57334L10.7735 6.01334C10.6695 6.32198 10.4561 6.58188 10.1737 6.744C9.89119 6.90612 9.55914 6.95924 9.24019 6.89334L6.66685 6.38667C6.40625 6.34984 6.14059 6.39097 5.90332 6.50486C5.66605 6.61875 5.46779 6.80031 5.33352 7.02667L2.66685 11.64C2.52173 11.8809 2.45648 12.1615 2.48043 12.4416C2.50438 12.7218 2.6163 12.9873 2.80019 13.2L4.49352 15.12C4.70728 15.3633 4.82517 15.6761 4.82517 16C4.82517 16.3239 4.70728 16.6367 4.49352 16.88L2.80019 18.8C2.6163 19.0127 2.50438 19.2782 2.48043 19.5584C2.45648 19.8386 2.52173 20.1191 2.66685 20.36L5.33352 24.9733C5.47365 25.2166 5.68701 25.4095 5.94319 25.5244C6.19937 25.6393 6.48529 25.6705 6.76019 25.6133L9.26685 25.1067C9.58581 25.0408 9.91786 25.0939 10.2003 25.256C10.4828 25.4181 10.6962 25.678 10.8002 25.9867L11.6135 28.4267C11.7063 28.7026 11.8868 28.9407 12.1276 29.1044C12.3684 29.2681 12.6561 29.3485 12.9469 29.3333H18.2802C18.5597 29.3341 18.8324 29.2469 19.0597 29.0842C19.287 28.9215 19.4574 28.6915 19.5469 28.4267L20.3602 25.9867C20.4642 25.678 20.6776 25.4181 20.96 25.256C21.2425 25.0939 21.5746 25.0408 21.8935 25.1067L24.4002 25.6133C24.6751 25.6705 24.961 25.6393 25.2172 25.5244C25.4734 25.4095 25.6867 25.2166 25.8269 24.9733L28.4935 20.36C28.6351 20.1164 28.6959 19.8343 28.6671 19.554C28.6384 19.2737 28.5216 19.0098 28.3335 18.8L26.5335 16.88ZM24.5469 18.6667L25.6135 19.8667L23.9069 22.8267L22.3335 22.5067C21.3732 22.3104 20.3743 22.4735 19.5263 22.9651C18.6783 23.4566 18.0404 24.2425 17.7335 25.1733L17.2269 26.6667H13.8135L13.3335 25.1467C13.0267 24.2158 12.3887 23.43 11.5407 22.9384C10.6928 22.4468 9.69381 22.2837 8.73352 22.48L7.16019 22.8L5.42685 19.8533L6.49352 18.6533C7.14946 17.92 7.5121 16.9706 7.5121 15.9867C7.5121 15.0028 7.14946 14.0534 6.49352 13.32L5.42685 12.12L7.13352 9.18667L8.70685 9.50667C9.66715 9.70297 10.6661 9.53984 11.5141 9.04827C12.362 8.55669 13 7.77088 13.3069 6.84L13.8135 5.33334H17.2269L17.7335 6.85334C18.0404 7.78421 18.6783 8.57002 19.5263 9.0616C20.3743 9.55318 21.3732 9.7163 22.3335 9.52L23.9069 9.2L25.6135 12.16L24.5469 13.36C23.8983 14.0917 23.5401 15.0356 23.5401 16.0133C23.5401 16.9911 23.8983 17.935 24.5469 18.6667ZM15.5202 10.6667C14.4654 10.6667 13.4342 10.9795 12.5571 11.5655C11.6801 12.1515 10.9965 12.9845 10.5928 13.959C10.1892 14.9336 10.0835 16.0059 10.2893 17.0405C10.4951 18.075 11.0031 19.0254 11.749 19.7712C12.4948 20.5171 13.4451 21.0251 14.4797 21.2309C15.5143 21.4366 16.5866 21.331 17.5612 20.9274C18.5357 20.5237 19.3687 19.8401 19.9547 18.963C20.5407 18.086 20.8535 17.0548 20.8535 16C20.8535 14.5855 20.2916 13.229 19.2914 12.2288C18.2912 11.2286 16.9347 10.6667 15.5202 10.6667ZM15.5202 18.6667C14.9928 18.6667 14.4772 18.5103 14.0387 18.2173C13.6001 17.9242 13.2583 17.5078 13.0565 17.0205C12.8547 16.5332 12.8019 15.997 12.9048 15.4798C13.0077 14.9625 13.2616 14.4873 13.6346 14.1144C14.0075 13.7414 14.4827 13.4875 14.9999 13.3846C15.5172 13.2817 16.0534 13.3345 16.5407 13.5363C17.0279 13.7382 17.4444 14.08 17.7374 14.5185C18.0305 14.957 18.1869 15.4726 18.1869 16C18.1869 16.7072 17.9059 17.3855 17.4058 17.8856C16.9057 18.3857 16.2274 18.6667 15.5202 18.6667Z"
                                    fill="currentColor" />
                            </svg>
                            <span>Cài đặt</span>
                        </a>
                    </li>
                </ul>

                <div class="sidebar__logout">
                    <button type="button" class="sidebar__link" onclick="openLogoutModal()" style="background: none; border: none; width: 100%; cursor: pointer;">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21.3333 22.6667L28 16M28 16L21.3333 9.33333M28 16H12M12 28H6.66667C5.95942 28 5.28115 27.719 4.78105 27.219C4.28095 26.7189 4 26.0406 4 25.3333V6.66667C4 5.95942 4.28095 5.28115 4.78105 4.78105C5.28115 4.28095 5.95942 4 6.66667 4H12" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <span>Đăng xuất</span>
                    </button>
                </div>
            </aside>

            <!-- Modal Overlay -->
            <div class="modal-overlay" id="modalOverlay" onclick="closeModalOnOverlay(event)" style="display: none;">
                <div class="modal">
                    <div class="icon-wrapper">
                        <svg class="alert-icon" width="33" height="29" viewBox="0 0 33 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 28.5L16.5 0L33 28.5H0ZM16.5 24C16.925 24 17.2815 23.856 17.5695 23.568C17.8575 23.28 18.001 22.924 18 22.5C17.999 22.076 17.855 21.72 17.568 21.432C17.281 21.144 16.925 21 16.5 21C16.075 21 15.719 21.144 15.432 21.432C15.145 21.72 15.001 22.076 15 22.5C14.999 22.924 15.143 23.2805 15.432 23.5695C15.721 23.8585 16.077 24.002 16.5 24ZM15 19.5H18V12H15V19.5Z" fill="#EC1313" />
                        </svg>
                    </div>
                    <h2>Xác nhận đăng xuất</h2>
                    <p>Bạn có chắc chắn muốn đăng xuất khỏi tài khoản không? Phiên làm việc của bạn sẽ kết thúc.</p>
                    <div class="button-group">
                        <button type="button" class="btn-modal btn-cancel" onclick="closeLogoutModal()">Hủy bỏ</button>
                        <button type="button" class="btn-modal btn-confirm" onclick="confirmAction()">Xác nhận</button>
                    </div>
                </div>
            </div>

            <!-- Header -->
            <header class="header">
                <div class="header__logo">
                    <a href="Home.aspx">
                        <img
                            src="../Assets/images/logo-home.png"
                            alt="Event Management Logo"
                            class="header__logo-image" />
                        <span>Admin</span>
                    </a>
                </div>
                <div class="header__actions">
                    <!-- Nút chuông thông báo -->
                    <div class="header__notification-wrapper">
                        <div class="header__notification" onclick="toggleNotificationDropdown(event)">
                            <svg class="header__notification-icon" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">

                                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.2106 2.23299C16.5569 3.13264 16.1605 4.19326 16.0639 5.3011C15.9673 6.40893 16.1741 7.52217 16.6621 8.5214C17.1502 9.52062 17.901 10.3681 18.8342 10.973C19.7673 11.5779 20.8475 11.9173 21.9589 11.9548V11.9677C21.9764 12.1987 21.9939 12.4355 22.0173 12.6642C22.2938 15.2857 22.9238 17.0858 23.5293 18.2677C23.9318 19.0552 24.3273 19.5778 24.6073 19.894C24.7302 20.0334 24.8627 20.164 25.0039 20.2848L25.0156 20.2918C25.1653 20.4005 25.2767 20.5538 25.3339 20.7297C25.391 20.9056 25.3909 21.0951 25.3337 21.271C25.2764 21.4469 25.1648 21.6001 25.015 21.7086C24.8652 21.8171 24.6849 21.8754 24.4999 21.875H3.49994C3.31538 21.8748 3.13561 21.8162 2.98634 21.7076C2.83708 21.5991 2.72596 21.4461 2.66888 21.2706C2.61179 21.0951 2.61167 20.906 2.66853 20.7304C2.72539 20.5548 2.83631 20.4017 2.98544 20.293L2.99478 20.2848L3.06944 20.2218C3.13944 20.1588 3.25261 20.0527 3.39261 19.894C3.67261 19.579 4.06811 19.0563 4.47061 18.2688C5.27561 16.695 6.12494 14.035 6.12494 9.79999C6.12494 7.60549 6.94161 5.49033 8.41161 3.92233C9.88394 2.35199 11.8929 1.45833 13.9999 1.45833C14.4464 1.45833 14.887 1.49761 15.3218 1.57616C15.5994 1.62633 16.5094 1.90983 17.2106 2.23299Z" fill="black" />
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.7915 5.83333C17.7915 4.67301 18.2525 3.56021 19.073 2.73974C19.8934 1.91926 21.0062 1.45833 22.1665 1.45833C23.3269 1.45833 24.4397 1.91926 25.2601 2.73974C26.0806 3.56021 26.5415 4.67301 26.5415 5.83333C26.5415 6.99365 26.0806 8.10645 25.2601 8.92692C24.4397 9.74739 23.3269 10.2083 22.1665 10.2083C21.0062 10.2083 19.8934 9.74739 19.073 8.92692C18.2525 8.10645 17.7915 6.99365 17.7915 5.83333ZM11.5429 23.7428C11.6423 23.6852 11.7521 23.6477 11.866 23.6326C11.9799 23.6174 12.0957 23.6248 12.2068 23.6544C12.3178 23.684 12.4219 23.7351 12.5132 23.8049C12.6045 23.8748 12.6811 23.9619 12.7387 24.0613C12.8669 24.2822 13.0509 24.4655 13.2723 24.5929C13.4936 24.7203 13.7445 24.7874 13.9999 24.7874C14.2553 24.7874 14.5062 24.7203 14.7275 24.5929C14.9488 24.4655 15.1328 24.2822 15.261 24.0613C15.3187 23.9619 15.3954 23.8748 15.4868 23.805C15.5781 23.7352 15.6823 23.6841 15.7934 23.6546C15.9045 23.6251 16.0203 23.6177 16.1343 23.633C16.2482 23.6482 16.358 23.6857 16.4575 23.7434C16.5569 23.8011 16.644 23.8778 16.7138 23.9691C16.7836 24.0605 16.8347 24.1647 16.8642 24.2758C16.8937 24.3869 16.9011 24.5027 16.8858 24.6166C16.8706 24.7306 16.8331 24.8404 16.7754 24.9398C16.4934 25.4261 16.0886 25.8298 15.6015 26.1105C15.1143 26.3911 14.562 26.5388 13.9999 26.5388C13.4377 26.5388 12.8854 26.3911 12.3983 26.1105C11.9112 25.8298 11.5064 25.4261 11.2244 24.9398C11.1666 24.8403 11.129 24.7304 11.1137 24.6164C11.0984 24.5024 11.1058 24.3865 11.1354 24.2753C11.165 24.1641 11.2162 24.0598 11.2861 23.9685C11.356 23.8771 11.4433 23.8004 11.5429 23.7428Z" fill="black" />
                            </svg>
                            <% if (UnreadCount > 0)
                                { %>
                            <span class="badge badge--danger header__notification-badge"><%= UnreadCount %></span>
                            <% } %>
                        </div>

                        <!-- Dropdown thông báo -->
                        <div class="header__notification-dropdown" id="notificationDropdown">
                            <% if (HeaderNotificationList == null || HeaderNotificationList.Rows.Count == 0)
                                { %>
                            <p class="notification-empty">Không có thông báo mới</p>
                            <% }
                            else
                            { %>
                            <% foreach (System.Data.DataRow row in HeaderNotificationList.Rows)
                                { %>
                            <a href="EventRegistrationManagement.aspx?id=<%= row["RelatedEventId"] %>" class="notification-item <%= Convert.ToBoolean(row["IsRead"]) ? "" : "notification-item--unread" %>">
                                <div class="notification-item__icon notification-item__icon--<%= row["Type"].ToString().ToLower() %>">
                                    <% if (row["Type"].ToString() == "Registration")
                                        { %>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M6 20C5.45 20 4.97933 19.8043 4.588 19.413C4.19667 19.0217 4.00067 18.5507 4 18C3.99934 17.4493 4.19533 16.9787 4.588 16.588C4.98067 16.1973 5.45134 16.0013 6 16C6.54867 15.9987 7.01967 16.1947 7.413 16.588C7.80634 16.9813 8.002 17.452 8 18C7.998 18.548 7.80234 19.019 7.413 19.413C7.02367 19.807 6.55267 20.0027 6 20ZM6 14C5.45 14 4.97933 13.8043 4.588 13.413C4.19667 13.0217 4.00067 12.5507 4 12C3.99934 11.4493 4.19533 10.9787 4.588 10.588C4.98067 10.1973 5.45134 10.0013 6 10C6.54867 9.99867 7.01967 10.1947 7.413 10.588C7.80634 10.9813 8.002 11.452 8 12C7.998 12.548 7.80234 13.019 7.413 13.413C7.02367 13.807 6.55267 14.0027 6 14ZM6 8.00001C5.45 8.00001 4.97933 7.80434 4.588 7.41301C4.19667 7.02167 4.00067 6.55067 4 6.00001C3.99934 5.44934 4.19533 4.97867 4.588 4.58801C4.98067 4.19734 5.45134 4.00134 6 4.00001C6.54867 3.99867 7.01967 4.19467 7.413 4.58801C7.80634 4.98134 8.002 5.45201 8 6.00001C7.998 6.54801 7.80234 7.01901 7.413 7.41301C7.02367 7.80701 6.55267 8.00267 6 8.00001ZM12 8.00001C11.45 8.00001 10.9793 7.80434 10.588 7.41301C10.1967 7.02167 10.0007 6.55067 10 6.00001C9.99934 5.44934 10.1953 4.97867 10.588 4.58801C10.9807 4.19734 11.4513 4.00134 12 4.00001C12.5487 3.99867 13.0197 4.19467 13.413 4.58801C13.8063 4.98134 14.002 5.45201 14 6.00001C13.998 6.54801 13.8023 7.01901 13.413 7.41301C13.0237 7.80701 12.5527 8.00267 12 8.00001ZM18 8.00001C17.45 8.00001 16.9793 7.80434 16.588 7.41301C16.1967 7.02167 16.0007 6.55067 16 6.00001C15.9993 5.44934 16.1953 4.97867 16.588 4.58801C16.9807 4.19734 17.4513 4.00134 18 4.00001C18.5487 3.99867 19.0197 4.19467 19.413 4.58801C19.8063 4.98134 20.002 5.45201 20 6.00001C19.998 6.54801 19.8023 7.01901 19.413 7.41301C19.0237 7.80701 18.5527 8.00267 18 8.00001ZM12 14C11.45 14 10.9793 13.8043 10.588 13.413C10.1967 13.0217 10.0007 12.5507 10 12C9.99934 11.4493 10.1953 10.9787 10.588 10.588C10.9807 10.1973 11.4513 10.0013 12 10C12.5487 9.99867 13.0197 10.1947 13.413 10.588C13.8063 10.9813 14.002 11.452 14 12C13.998 12.548 13.8023 13.019 13.413 13.413C13.0237 13.807 12.5527 14.0027 12 14ZM13 20V16.925L18.525 11.425C18.675 11.275 18.8417 11.1667 19.025 11.1C19.2083 11.0333 19.3917 11 19.575 11C19.775 11 19.9667 11.0377 20.15 11.113C20.3333 11.1883 20.5 11.3007 20.65 11.45L21.575 12.375C21.7083 12.525 21.8127 12.6917 21.888 12.875C21.9633 13.0583 22.0007 13.2417 22 13.425C21.9993 13.6083 21.966 13.796 21.9 13.988C21.834 14.18 21.7257 14.3507 21.575 14.5L16.075 20H13ZM14.5 18.5H15.45L18.475 15.45L18.025 14.975L17.55 14.525L14.5 17.55V18.5ZM18.025 14.975L17.55 14.525L18.475 15.45L18.025 14.975Z" fill="currentColor" />
                                    </svg>
                                    <% }
                                        else if (row["Type"].ToString() == "Event")
                                        { %>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M14.5 18C13.8 18 13.2083 17.7583 12.725 17.275C12.2417 16.7917 12 16.2 12 15.5C12 14.8 12.2417 14.2083 12.725 13.725C13.2083 13.2417 13.8 13 14.5 13C15.2 13 15.7917 13.2417 16.275 13.725C16.7583 14.2083 17 14.8 17 15.5C17 16.2 16.7583 16.7917 16.275 17.275C15.7917 17.7583 15.2 18 14.5 18ZM5 22C4.45 22 3.97933 21.8043 3.588 21.413C3.19667 21.0217 3.00067 20.5507 3 20V6C3 5.45 3.196 4.97934 3.588 4.588C3.98 4.19667 4.45067 4.00067 5 4H6V3C6 2.71667 6.096 2.47934 6.288 2.288C6.48 2.09667 6.71733 2.00067 7 2C7.28267 1.99934 7.52033 2.09534 7.713 2.288C7.90567 2.48067 8.00133 2.718 8 3V4H16V3C16 2.71667 16.096 2.47934 16.288 2.288C16.48 2.09667 16.7173 2.00067 17 2C17.2827 1.99934 17.5203 2.09534 17.713 2.288C17.9057 2.48067 18.0013 2.718 18 3V4H19C19.55 4 20.021 4.196 20.413 4.588C20.805 4.98 21.0007 5.45067 21 6V20C21 20.55 20.8043 21.021 20.413 21.413C20.0217 21.805 19.5507 22.0007 19 22H5ZM5 20H19V10H5V20ZM5 8H19V6H5V8Z" fill="currentColor" />
                                    </svg>
                                    <% }
                                        else
                                        { %>
                                    <!-- System -->
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19.8999 12.66C19.7396 12.4775 19.6512 12.2429 19.6512 12C19.6512 11.7571 19.7396 11.5225 19.8999 11.34L21.1799 9.9C21.3209 9.74267 21.4085 9.54471 21.4301 9.33451C21.4516 9.12431 21.4061 8.91269 21.2999 8.73L19.2999 5.27C19.1948 5.08752 19.0348 4.94288 18.8426 4.85669C18.6505 4.7705 18.4361 4.74716 18.2299 4.79L16.3499 5.17C16.1107 5.21943 15.8616 5.17959 15.6498 5.058C15.4379 4.93641 15.2779 4.74149 15.1999 4.51L14.5899 2.68C14.5228 2.48138 14.395 2.30887 14.2245 2.18684C14.0541 2.06482 13.8495 1.99946 13.6399 2H9.6399C9.42183 1.98862 9.20603 2.04893 9.02546 2.17172C8.84489 2.2945 8.70948 2.47302 8.6399 2.68L8.0799 4.51C8.0019 4.74149 7.84187 4.93641 7.63001 5.058C7.41815 5.17959 7.16911 5.21943 6.9299 5.17L4.9999 4.79C4.80445 4.76238 4.6052 4.79322 4.42724 4.87864C4.24929 4.96406 4.1006 5.10023 3.9999 5.27L1.9999 8.73C1.89106 8.91065 1.84212 9.12109 1.86008 9.33123C1.87804 9.54136 1.96198 9.74044 2.0999 9.9L3.3699 11.34C3.53022 11.5225 3.61863 11.7571 3.61863 12C3.61863 12.2429 3.53022 12.4775 3.3699 12.66L2.0999 14.1C1.96198 14.2596 1.87804 14.4586 1.86008 14.6688C1.84212 14.8789 1.89106 15.0894 1.9999 15.27L3.9999 18.73C4.10499 18.9125 4.26502 19.0571 4.45715 19.1433C4.64928 19.2295 4.86372 19.2528 5.0699 19.21L6.9499 18.83C7.18911 18.7806 7.43815 18.8204 7.65001 18.942C7.86187 19.0636 8.0219 19.2585 8.0999 19.49L8.7099 21.32C8.77948 21.527 8.91489 21.7055 9.09546 21.8283C9.27603 21.9511 9.49183 22.0114 9.7099 22H13.7099C13.9195 22.0005 14.1241 21.9352 14.2945 21.8132C14.465 21.6911 14.5928 21.5186 14.6599 21.32L15.2699 19.49C15.3479 19.2585 15.5079 19.0636 15.7198 18.942C15.9316 18.8204 16.1807 18.7806 16.4199 18.83L18.2999 19.21C18.5061 19.2528 18.7205 19.2295 18.9126 19.1433C19.1048 19.0571 19.2648 18.9125 19.3699 18.73L21.3699 15.27C21.4761 15.0873 21.5216 14.8757 21.5001 14.6655C21.4785 14.4553 21.3909 14.2573 21.2499 14.1L19.8999 12.66ZM18.4099 14L19.2099 14.9L17.9299 17.12L16.7499 16.88C16.0297 16.7328 15.2805 16.8551 14.6445 17.2238C14.0085 17.5925 13.53 18.1818 13.2999 18.88L12.9199 20H10.3599L9.9999 18.86C9.76975 18.1618 9.29128 17.5725 8.6553 17.2038C8.01932 16.8351 7.27012 16.7128 6.5499 16.86L5.3699 17.1L4.0699 14.89L4.8699 13.99C5.36185 13.44 5.63383 12.7279 5.63383 11.99C5.63383 11.2521 5.36185 10.54 4.8699 9.99L4.0699 9.09L5.3499 6.89L6.5299 7.13C7.25012 7.27722 7.99932 7.15488 8.6353 6.7862C9.27128 6.41752 9.74975 5.82816 9.9799 5.13L10.3599 4H12.9199L13.2999 5.14C13.53 5.83816 14.0085 6.42752 14.6445 6.7962C15.2805 7.16488 16.0297 7.28722 16.7499 7.14L17.9299 6.9L19.2099 9.12L18.4099 10.02C17.9235 10.5688 17.6549 11.2767 17.6549 12.01C17.6549 12.7433 17.9235 13.4512 18.4099 14ZM11.6399 8C10.8488 8 10.0754 8.2346 9.41761 8.67412C8.75982 9.11365 8.24713 9.73836 7.94438 10.4693C7.64163 11.2002 7.56241 12.0044 7.71675 12.7804C7.8711 13.5563 8.25206 14.269 8.81147 14.8284C9.37088 15.3878 10.0836 15.7688 10.8595 15.9231C11.6355 16.0775 12.4397 15.9983 13.1706 15.6955C13.9015 15.3928 14.5262 14.8801 14.9658 14.2223C15.4053 13.5645 15.6399 12.7911 15.6399 12C15.6399 10.9391 15.2185 9.92172 14.4683 9.17157C13.7182 8.42143 12.7008 8 11.6399 8ZM11.6399 14C11.2443 14 10.8577 13.8827 10.5288 13.6629C10.1999 13.4432 9.94351 13.1308 9.79214 12.7654C9.64076 12.3999 9.60116 11.9978 9.67833 11.6098C9.7555 11.2219 9.94598 10.8655 10.2257 10.5858C10.5054 10.3061 10.8618 10.1156 11.2497 10.0384C11.6377 9.96126 12.0398 10.0009 12.4053 10.1522C12.7707 10.3036 13.0831 10.56 13.3028 10.8889C13.5226 11.2178 13.6399 11.6044 13.6399 12C13.6399 12.5304 13.4292 13.0391 13.0541 13.4142C12.679 13.7893 12.1703 14 11.6399 14Z" fill="currentColor" />
                                    </svg>
                                    <% } %>
                                </div>
                                <div class="notification-item__content">
                                    <h4><%= row["Title"] %></h4>
                                    <p><%= row["Message"] %></p>
                                    <time><%= GetRelativeTime(Convert.ToDateTime(row["CreatedAt"])) %></time>
                                </div>
                            </a>
                            <% } %>
                            <a href="Notification.aspx" class="notification-view-all">Xem tất cả thông báo →</a>
                            <% } %>
                        </div>
                    </div>

                    <!-- Nút avatar -->
                    <img class="header__avatar" src="<%= UserAvatar %>" alt="Avatar" onclick="toggleAvatarMenu(event)" />


                    <!-- Menu avatar (mobile only) -->
                    <div class="header__avatar-menu" id="avatarMenu">
                        <a href="Setting.aspx">Cài đặt</a>
                        <hr />
                        <button type="submit" name="btnAction" value="logout" class="avatar-menu__logout">Đăng xuất</button>
                    </div>
                </div>
            </header>

            <!-- Main -->
            <main class="main">
                <div class="main__header">
                    <h1 class="main__title">Quản lý nhân viên</h1>
                    <a href="CreateNewUser.aspx" class="btn btn--primary">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12ZM12 4C9.87827 4 7.84344 4.84285 6.34315 6.34315C4.84285 7.84344 4 9.87827 4 12C4 14.1217 4.84285 16.1566 6.34315 17.6569C7.84344 19.1571 9.87827 20 12 20C14.1217 20 16.1566 19.1571 17.6569 17.6569C19.1571 16.1566 20 14.1217 20 12C20 9.87827 19.1571 7.84344 17.6569 6.34315C16.1566 4.84285 14.1217 4 12 4Z" fill="white" />
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M13 7C13 6.73478 12.8946 6.48043 12.7071 6.29289C12.5196 6.10536 12.2652 6 12 6C11.7348 6 11.4804 6.10536 11.2929 6.29289C11.1054 6.48043 11 6.73478 11 7V11H7C6.73478 11 6.48043 11.1054 6.29289 11.2929C6.10536 11.4804 6 11.7348 6 12C6 12.2652 6.10536 12.5196 6.29289 12.7071C6.48043 12.8946 6.73478 13 7 13H11V17C11 17.2652 11.1054 17.5196 11.2929 17.7071C11.4804 17.8946 11.7348 18 12 18C12.2652 18 12.5196 17.8946 12.7071 17.7071C12.8946 17.5196 13 17.2652 13 17V13H17C17.2652 13 17.5196 12.8946 17.7071 12.7071C17.8946 12.5196 18 12.2652 18 12C18 11.7348 17.8946 11.4804 17.7071 11.2929C17.5196 11.1054 17.2652 11 17 11H13V7Z" fill="white" />
                        </svg>
                        Thêm nhân viên mới
                    </a>
                </div>

                <section class="user-filter">
                    <div class="user-filter__search">
                        <label class="user-filter__label">Tìm kiếm</label>
                        <div class="user-filter__search-wrapper">
                            <svg class="user-filter__search-icon" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M6.5 13C4.68333 13 3.146 12.3707 1.888 11.112C0.63 9.85333 0.000667196 8.316 5.29101e-07 6.5C-0.000666138 4.684 0.628667 3.14667 1.888 1.888C3.14733 0.629333 4.68467 0 6.5 0C8.31533 0 9.853 0.629333 11.113 1.888C12.373 3.14667 13.002 4.684 13 6.5C13 7.23333 12.8833 7.925 12.65 8.575C12.4167 9.225 12.1 9.8 11.7 10.3L17.3 15.9C17.4833 16.0833 17.575 16.3167 17.575 16.6C17.575 16.8833 17.4833 17.1167 17.3 17.3C17.1167 17.4833 16.8833 17.575 16.6 17.575C16.3167 17.575 16.0833 17.4833 15.9 17.3L10.3 11.7C9.8 12.1 9.225 12.4167 8.575 12.65C7.925 12.8833 7.23333 13 6.5 13ZM6.5 11C7.75 11 8.81267 10.5627 9.688 9.688C10.5633 8.81333 11.0007 7.75067 11 6.5C10.9993 5.24933 10.562 4.187 9.688 3.313C8.814 2.439 7.75133 2.00133 6.5 2C5.24867 1.99867 4.18633 2.43633 3.313 3.313C2.43967 4.18967 2.002 5.252 2 6.5C1.998 7.748 2.43567 8.81067 3.313 9.688C4.19033 10.5653 5.25267 11.0027 6.5 11Z" fill="#111827" />
                            </svg>
                            <input type="text" name="txtSearch" class="user-filter__search-input"
                                placeholder="Tên, email hoặc số điện thoại..." value="<%= SearchTerm %>"
                                onkeydown="if(event.keyCode==13){ this.form.submit(); return false; }" />
                        </div>
                    </div>

                    <div class="user-filter__field">
                        <label for="ddlStatus" class="user-filter__label">Trạng thái:</label>
                        <div class="user-filter__select-wrapper">
                            <select name="ddlStatus" id="ddlStatus" class="user-filter__select" onchange="this.form.submit()">
                                <option value="ALL" <%= SelectedStatus == "ALL" ? "selected" : "" %>>Tất cả</option>
                                <option value="1" <%= SelectedStatus == "1" ? "selected" : "" %>>Đang hoạt động</option>
                                <option value="0" <%= SelectedStatus == "0" ? "selected" : "" %>>Đã vô hiệu hóa</option>
                            </select>
                            <svg class="user-filter__select-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M1 1.5L6 6.5L11 1.5" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                    </div>

                    <button type="submit" name="btnAction" value="reset" class="user-filter__reset">
                        <svg class="user-filter__reset-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 10C20 15.523 15.523 20 10 20C4.477 20 0 15.523 0 10C0 4.477 4.477 0 10 0V2C8.11876 2.00015 6.29775 2.66326 4.85692 3.87283C3.41608 5.0824 2.4476 6.76104 2.12164 8.61383C1.79567 10.4666 2.13307 12.375 3.07456 14.0037C4.01605 15.6324 5.5014 16.8772 7.26962 17.5194C9.03785 18.1616 10.9758 18.1601 12.7431 17.5152C14.5103 16.8703 15.9938 15.6233 16.9328 13.9931C17.8718 12.363 18.2063 10.4541 17.8775 8.60182C17.5487 6.74954 16.5777 5.07237 15.135 3.865L13 6V0H19L16.553 2.447C17.636 3.38479 18.5044 4.54475 19.0992 5.84804C19.694 7.15133 20.0012 8.5674 20 10Z" fill="currentColor" />
                        </svg>
                        <span>Đặt lại</span>
                    </button>
                </section>

                <div class="table" role="table" aria-label="Danh sách nhân viên">
                    <div class="table__header" role="row">
                        <div class="table__header-cell" role="columnheader">Avatar</div>
                        <div class="table__header-cell" role="columnheader">Họ và tên</div>
                        <div class="table__header-cell" role="columnheader">Email</div>
                        <div class="table__header-cell" role="columnheader">Số điện thoại</div>
                        <div class="table__header-cell" role="columnheader">Trạng thái</div>
                        <div class="table__header-cell" role="columnheader">Ngày tạo</div>
                        <div class="table__header-cell" role="columnheader">Hành động</div>
                    </div>
                    <div class="table__body">
                        <% if (UserList.Rows.Count == 0)
                            { %>
                        <div class="table__row table__row--empty">
                            <p>Không tìm thấy nhân viên nào phù hợp với bộ lọc.</p>
                        </div>
                        <% }
                            else
                            { %>
                        <% foreach (DataRow row in UserList.Rows)
                            { %>
                        <article class="table__row" role="row">
                            <div class="table__cell" role="cell">
                                <img src="<%= GetUserAvatar(row["Avatar"]) %>" alt="<%= row["FullName"] %>" class="table__thumbnail">
                            </div>
                            <div class="table__cell" role="cell">
                                <div class="table__name-title"><%= row["FullName"] %></div>
                            </div>
                            <div class="table__cell" role="cell"><%= row["Email"] %></div>
                            <div class="table__cell" role="cell"><%= row["Phone"] ?? "-" %></div>
                            <div class="table__cell" role="cell">
                                <span class="badge <%= row["IsActive"].ToString() == "1" ? "badge--active" : "badge--disable" %>">
                                    <%= row["IsActive"].ToString() == "1" ? "Hoạt động" : "Vô hiệu hóa" %>
                                </span>
                            </div>
                            <div class="table__cell table__registrations" role="cell">
                                <%= Convert.ToDateTime(row["CreatedAt"]).ToString("dd-MM-yyyy") %>
                            </div>
                            <div class="table__cell table__actions" role="cell">
                                <a href="CreateNewUser.aspx?id=<%= row["Id"] %>" class="action-btn action-btn--view" aria-label="Xem nhân viên" title="Xem">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 9C12.7956 9 13.5587 9.31607 14.1213 9.87868C14.6839 10.4413 15 11.2044 15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7956 15 12 15C11.2044 15 10.4413 14.6839 9.87868 14.1213C9.31607 13.5587 9 12.7956 9 12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9ZM12 4.5C17 4.5 21.27 7.61 23 12C21.27 16.39 17 19.5 12 19.5C7 19.5 2.73 16.39 1 12C2.73 7.61 7 4.5 12 4.5ZM3.18 12C3.98825 13.6503 5.24331 15.0407 6.80248 16.0133C8.36165 16.9858 10.1624 17.5013 12 17.5013C13.8376 17.5013 15.6383 16.9858 17.1975 16.0133C18.7567 15.0407 20.0117 13.6503 20.82 12C20.0117 10.3497 18.7567 8.95925 17.1975 7.98675C15.6383 7.01424 13.8376 6.49868 12 6.49868C10.1624 6.49868 8.36165 7.01424 6.80248 7.98675C5.24331 8.95925 3.98825 10.3497 3.18 12Z" fill="currentColor" />
                                    </svg>
                                </a>
                                <label class="switch">
                                    <input type="checkbox"
                                        name="status_checkbox"
                                        value="<%= row["Id"] %>"
                                        <%= row["IsActive"].ToString() == "1" ? "checked" : "" %>
                                        onchange="handleToggle(<%= row["Id"] %>, this.checked)" />
                                    <span class="slider round"></span>
                                </label>
                                <button class="action-btn action-btn--delete" aria-label="Xóa nhân viên" title="Xóa" onclick="openDeleteModal(<%= row["Id"] %>); return false;">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 3H10.5C10.3011 3 10.1103 3.07902 9.96964 3.21967C9.82898 3.36032 9.74996 3.55109 9.74996 3.75V4.5H14.25V3.75C14.25 3.55109 14.1709 3.36032 14.0303 3.21967C13.8896 3.07902 13.6989 3 13.5 3ZM16.5 4.5V3.75C16.5 2.95435 16.1839 2.19129 15.6213 1.62868C15.0587 1.06607 14.2956 0.75 13.5 0.75H10.5C9.70432 0.75 8.94125 1.06607 8.37864 1.62868C7.81604 2.19129 7.49997 2.95435 7.49996 3.75V4.5H3.37646C3.0781 4.5 2.79195 4.61853 2.58097 4.8295C2.36999 5.04048 2.25146 5.32663 2.25146 5.625C2.25146 5.92337 2.36999 6.20952 2.58097 6.4205C2.79195 6.63147 3.0781 6.75 3.37646 6.75H3.84446L4.31996 18.1875C4.36835 19.3477 4.86332 20.4442 5.7014 21.2479C6.53948 22.0516 7.6558 22.5002 8.81696 22.5H15.1845C16.3454 22.4998 17.4613 22.051 18.2991 21.2474C19.1368 20.4437 19.6316 19.3474 19.68 18.1875L20.157 6.75H20.625C20.9233 6.75 21.2095 6.63147 21.4205 6.4205C21.6314 6.20952 21.75 5.92337 21.75 5.625C21.75 5.32663 21.6314 5.04048 21.4205 4.8295C21.2095 4.61853 20.9233 4.5 20.625 4.5H16.5ZM17.904 6.75H6.09597L6.56847 18.093C6.59247 18.6732 6.83987 19.2217 7.25893 19.6237C7.67799 20.0257 8.23626 20.2501 8.81696 20.25H15.1845C15.7649 20.2497 16.3228 20.0251 16.7415 19.6232C17.1603 19.2212 17.4075 18.673 17.4315 18.093L17.904 6.75ZM8.62496 9.75V17.25C8.62497 17.5484 8.74349 17.8345 8.95447 18.0455C9.16545 18.2565 9.4516 18.375 9.74996 18.375C10.0483 18.375 10.3345 18.2565 10.5455 18.0455C10.7564 17.8345 10.875 17.5484 10.875 17.25V9.75C10.875 9.45163 10.7564 9.16548 10.5455 8.9545C10.3345 8.74353 10.0483 8.625 9.74996 8.625C9.4516 8.625 9.16545 8.74353 8.95447 8.9545C8.74349 9.16548 8.62497 9.45163 8.62496 9.75ZM14.25 8.625C14.5483 8.625 14.8345 8.74353 15.0455 8.9545C15.2564 9.16548 15.375 9.45163 15.375 9.75V17.25C15.375 17.5484 15.2564 17.8345 15.0455 18.0455C14.8345 18.2565 14.5483 18.375 14.25 18.375C13.9516 18.375 13.6654 18.2565 13.4545 18.0455C13.2435 17.8345 13.125 17.5484 13.125 17.25V9.75C13.125 9.45163 13.2435 9.16548 13.4545 8.9545C13.6654 8.74353 13.9516 8.625 14.25 8.625Z" fill="currentColor" />
                                    </svg>
                                </button>
                            </div>
                        </article>
                        <% } %>
                        <% } %>
                    </div>
                </div>

                <!-- User Cards (mobile view) -->
                <aside class="cards-panel" aria-label="Danh sách nhân viên dạng thẻ">
                    <% if (UserList.Rows.Count == 0)
                        { %>
                    <div class="no-data">
                        <p>Không tìm thấy nhân viên nào phù hợp với bộ lọc.</p>
                    </div>
                    <% }
                        else
                        { %>
                    <% foreach (DataRow row in UserList.Rows)
                        { %>
                    <article class="user-card">
                        <div class="user-card__content">
                            <div class="user-card__avatar">
                                <img src="<%= GetUserAvatar(row["Avatar"]) %>" alt="<%= row["FullName"] %>" class="user-card__image">
                                <div class="user-card__header">
                                    <h3 class="user-card__name"><%= row["FullName"] %></h3>
                                    <p class="user-card__mail table__cell"><%= row["Email"] %></p>
                                </div>
                            </div>
                            <div class="user-card__meta">
                                <div class="user-card__meta-item">
                                    <p class="user-card__meta-label">Số điện thoại:</p>
                                    <span><%= row["Phone"] ?? "-" %></span>
                                </div>
                                <div class="user-card__meta-item">
                                    <p class="user-card__meta-label">Ngày tạo:</p>
                                    <span><%= Convert.ToDateTime(row["CreatedAt"]).ToString("dd-MM-yyyy") %></span>
                                </div>
                            </div>
                            <div class="user-card__footer">
                                <span class="badge <%= row["IsActive"].ToString() == "1" ? "badge--active" : "badge--disable" %>">
                                    <%= row["IsActive"].ToString() == "1" ? "Hoạt động" : "Vô hiệu hóa" %>
                                </span>
                                <div class="user-card__action">
                                    <a href="CreateNewUser.aspx?id=<%= row["Id"] %>" class="action-btn action-btn--view" aria-label="Xem nhân viên" title="Xem">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12 9C12.7956 9 13.5587 9.31607 14.1213 9.87868C14.6839 10.4413 15 11.2044 15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7956 15 12 15C11.2044 15 10.4413 14.6839 9.87868 14.1213C9.31607 13.5587 9 12.7956 9 12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9ZM12 4.5C17 4.5 21.27 7.61 23 12C21.27 16.39 17 19.5 12 19.5C7 19.5 2.73 16.39 1 12C2.73 7.61 7 4.5 12 4.5ZM3.18 12C3.98825 13.6503 5.24331 15.0407 6.80248 16.0133C8.36165 16.9858 10.1624 17.5013 12 17.5013C13.8376 17.5013 15.6383 16.9858 17.1975 16.0133C18.7567 15.0407 20.0117 13.6503 20.82 12C20.0117 10.3497 18.7567 8.95925 17.1975 7.98675C15.6383 7.01424 13.8376 6.49868 12 6.49868C10.1624 6.49868 8.36165 7.01424 6.80248 7.98675C5.24331 8.95925 3.98825 10.3497 3.18 12Z" fill="currentColor" />
                                        </svg>
                                    </a>
                                    <!-- Hidden luôn gửi key toggle_xx với giá trị mặc định "off" -->
                                    <input type="hidden" name="toggle_<%= row["Id"] %>" value="off" />

                                    <label class="switch">
                                        <input type="checkbox"
                                            name="toggle_<%= row["Id"] %>"
                                            value="on"
                                            <%= row["IsActive"].ToString() == "1" ? "checked" : "" %>
                                            onchange="this.form.submit()" />
                                        <span class="slider round"></span>
                                    </label>
                                    <button class="action-btn action-btn--delete" aria-label="Xóa nhân viên" title="Xóa" onclick="openDeleteModal(<%= row["Id"] %>); return false;">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 3H10.5C10.3011 3 10.1103 3.07902 9.96964 3.21967C9.82898 3.36032 9.74996 3.55109 9.74996 3.75V4.5H14.25V3.75C14.25 3.55109 14.1709 3.36032 14.0303 3.21967C13.8896 3.07902 13.6989 3 13.5 3ZM16.5 4.5V3.75C16.5 2.95435 16.1839 2.19129 15.6213 1.62868C15.0587 1.06607 14.2956 0.75 13.5 0.75H10.5C9.70432 0.75 8.94125 1.06607 8.37864 1.62868C7.81604 2.19129 7.49997 2.95435 7.49996 3.75V4.5H3.37646C3.0781 4.5 2.79195 4.61853 2.58097 4.8295C2.36999 5.04048 2.25146 5.32663 2.25146 5.625C2.25146 5.92337 2.36999 6.20952 2.58097 6.4205C2.79195 6.63147 3.0781 6.75 3.37646 6.75H3.84446L4.31996 18.1875C4.36835 19.3477 4.86332 20.4442 5.7014 21.2479C6.53948 22.0516 7.6558 22.5002 8.81696 22.5H15.1845C16.3454 22.4998 17.4613 22.051 18.2991 21.2474C19.1368 20.4437 19.6316 19.3474 19.68 18.1875L20.157 6.75H20.625C20.9233 6.75 21.2095 6.63147 21.4205 6.4205C21.6314 6.20952 21.75 5.92337 21.75 5.625C21.75 5.32663 21.6314 5.04048 21.4205 4.8295C21.2095 4.61853 20.9233 4.5 20.625 4.5H16.5ZM17.904 6.75H6.09597L6.56847 18.093C6.59247 18.6732 6.83987 19.2217 7.25893 19.6237C7.67799 20.0257 8.23626 20.2501 8.81696 20.25H15.1845C15.7649 20.2497 16.3228 20.0251 16.7415 19.6232C17.1603 19.2212 17.4075 18.673 17.4315 18.093L17.904 6.75ZM8.62496 9.75V17.25C8.62497 17.5484 8.74349 17.8345 8.95447 18.0455C9.16545 18.2565 9.4516 18.375 9.74996 18.375C10.0483 18.375 10.3345 18.2565 10.5455 18.0455C10.7564 17.8345 10.875 17.5484 10.875 17.25V9.75C10.875 9.45163 10.7564 9.16548 10.5455 8.9545C10.3345 8.74353 10.0483 8.625 9.74996 8.625C9.4516 8.625 9.16545 8.74353 8.95447 8.9545C8.74349 9.16548 8.62497 9.45163 8.62496 9.75ZM14.25 8.625C14.5483 8.625 14.8345 8.74353 15.0455 8.9545C15.2564 9.16548 15.375 9.45163 15.375 9.75V17.25C15.375 17.5484 15.2564 17.8345 15.0455 18.0455C14.8345 18.2565 14.5483 18.375 14.25 18.375C13.9516 18.375 13.6654 18.2565 13.4545 18.0455C13.2435 17.8345 13.125 17.5484 13.125 17.25V9.75C13.125 9.45163 13.2435 9.16548 13.4545 8.9545C13.6654 8.74353 13.9516 8.625 14.25 8.625Z" fill="currentColor" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </article>
                    <% } %>
                    <% } %>
                </aside>

                <!-- Phân trang -->
                <nav class="pagination" aria-label="Phân trang quản lý nhân viên">
                    <div class="pagination__info">
                        Hiển thị <%= (CurrentPage - 1) * PageSize + 1 %> - 
                        <%= Math.Min(CurrentPage * PageSize, TotalRecords) %> 
                        trong <%= TotalRecords %> <%= TotalRecords <= 1 ? "nhân viên" : "nhân viên" %>
                    </div>
                    <div class="pagination__controls">
                        <!-- Nút Previous -->
                        <button type="submit"
                            name="pageAction"
                            value="<%= CurrentPage - 1 %>"
                            class="pagination__btn"
                            <%= CurrentPage == 1 ? "disabled" : "" %>
                            aria-label="Trang trước">
                            ‹</button>

                        <!-- Các số trang -->
                        <% for (int i = 1; i <= TotalPages; i++)
                            { %>
                        <button type="submit"
                            name="pageAction"
                            value="<%= i %>"
                            class="pagination__btn <%= i == CurrentPage ? "pagination__btn--active" : "" %>"
                            aria-label="Trang <%= i %>"
                            <%= i == CurrentPage ? "aria-current=\"page\"" : "" %>>
                            <%= i %>
                        </button>
                        <% } %>

                        <!-- Nút Next -->
                        <button type="submit"
                            name="pageAction"
                            value="<%= CurrentPage + 1 %>"
                            class="pagination__btn"
                            <%= CurrentPage == TotalPages ? "disabled" : "" %>
                            aria-label="Trang tiếp theo">
                            ›</button>
                    </div>
                </nav>
            </main>

            <!-- Nav Mobile -->
            <nav class="nav">
                <ul class="nav__mobile">
                    <li class="nav__item">
                        <a href="Dashboard.aspx" class="nav__link ">
                            <svg width="24" height="26" viewBox="0 0 24 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5.625 19.75H8.8125V14.75C8.8125 14.4667 8.9145 14.2293 9.1185 14.038C9.3225 13.8467 9.57467 13.7507 9.875 13.75H14.125C14.426 13.75 14.6786 13.846 14.8826 14.038C15.0866 14.23 15.1882 14.4673 15.1875 14.75V19.75H18.375V10.75L12 6.25L5.625 10.75V19.75ZM3.5 19.75V10.75C3.5 10.4333 3.57544 10.1333 3.72631 9.85C3.87719 9.56667 4.08508 9.33333 4.35 9.15L10.725 4.65C11.0969 4.38333 11.5219 4.25 12 4.25C12.4781 4.25 12.9031 4.38333 13.275 4.65L19.65 9.15C19.9156 9.33333 20.1239 9.56667 20.2747 9.85C20.4256 10.1333 20.5007 10.4333 20.5 10.75V19.75C20.5 20.3 20.2917 20.771 19.8752 21.163C19.4587 21.555 18.9587 21.7507 18.375 21.75H14.125C13.824 21.75 13.5718 21.654 13.3685 21.462C13.1652 21.27 13.0632 21.0327 13.0625 20.75V15.75H10.9375V20.75C10.9375 21.0333 10.8355 21.271 10.6315 21.463C10.4275 21.655 10.1753 21.7507 9.875 21.75H5.625C5.04062 21.75 4.54054 21.5543 4.12475 21.163C3.70896 20.7717 3.50071 20.3007 3.5 19.75Z" fill="currentColor" />
                            </svg>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="EventManagement.aspx" class="nav__link ">
                            <svg width="24" height="27" viewBox="0 0 24 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.27778 13.5H9.16667V15.4H7.27778V13.5ZM20.5 7.8V21.1C20.5 22.1545 19.6594 23 18.6111 23H5.38889C4.88792 23 4.40748 22.7998 4.05324 22.4435C3.69901 22.0872 3.5 21.6039 3.5 21.1V7.8C3.5 6.755 4.35 5.9 5.38889 5.9H6.33333V4H8.22222V5.9H15.7778V4H17.6667V5.9H18.6111C19.1121 5.9 19.5925 6.10018 19.9468 6.4565C20.301 6.81282 20.5 7.29609 20.5 7.8ZM5.38889 9.7H18.6111V7.8H5.38889V9.7ZM18.6111 21.1V11.6H5.38889V21.1H18.6111ZM14.8333 15.4H16.7222V13.5H14.8333V15.4ZM11.0556 15.4H12.9444V13.5H11.0556V15.4Z" fill="currentColor" />
                            </svg>
                            <span>Sự kiện</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="UserManagement.aspx" class="nav__link nav__link--active">
                            <svg width="36" height="27" viewBox="0 0 36 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19.2305 12.2647C19.9291 11.3028 20.3047 10.1496 20.3047 8.9667C20.3047 7.78383 19.9291 6.63061 19.2305 5.66871C19.8846 5.22958 20.6585 4.99641 21.45 5.00004C22.5175 5.00004 23.5413 5.41796 24.2961 6.16185C25.0509 6.90574 25.475 7.91468 25.475 8.9667C25.475 10.0187 25.0509 11.0277 24.2961 11.7715C23.5413 12.5154 22.5175 12.9334 21.45 12.9334C20.6585 12.937 19.8846 12.7038 19.2305 12.2647ZM10.525 8.9667C10.525 8.18217 10.7611 7.41526 11.2033 6.76294C11.6456 6.11063 12.2742 5.60221 13.0097 5.30199C13.7452 5.00176 14.5545 4.92321 15.3352 5.07626C16.116 5.22931 16.8332 5.6071 17.3961 6.16185C17.959 6.7166 18.3424 7.42339 18.4977 8.19284C18.653 8.9623 18.5733 9.75986 18.2686 10.4847C17.964 11.2095 17.4481 11.829 16.7862 12.2649C16.1243 12.7007 15.3461 12.9334 14.55 12.9334C13.4825 12.9334 12.4587 12.5154 11.7039 11.7715C10.9491 11.0277 10.525 10.0187 10.525 8.9667ZM12.825 8.9667C12.825 9.30293 12.9262 9.6316 13.1157 9.91116C13.3053 10.1907 13.5747 10.4086 13.8899 10.5373C14.2051 10.666 14.5519 10.6996 14.8865 10.634C15.2211 10.5684 15.5285 10.4065 15.7698 10.1688C16.011 9.93103 16.1753 9.62812 16.2419 9.29835C16.3084 8.96858 16.2743 8.62677 16.1437 8.31614C16.0131 8.0055 15.792 7.74 15.5084 7.5532C15.2247 7.36641 14.8912 7.2667 14.55 7.2667C14.0925 7.2667 13.6537 7.44581 13.3302 7.76462C13.0067 8.08343 12.825 8.51583 12.825 8.9667ZM22.6 19.7333V22H6.5V19.7333C6.5 19.7333 6.5 15.2 14.55 15.2C22.6 15.2 22.6 19.7333 22.6 19.7333ZM20.3 19.7333C20.139 18.8493 18.7705 17.4667 14.55 17.4667C10.3295 17.4667 8.8805 18.9513 8.8 19.7333M22.5425 15.2C23.2473 15.7403 23.8236 16.4261 24.2309 17.2093C24.6382 17.9924 24.8666 18.8539 24.9 19.7333V22H29.5V19.7333C29.5 19.7333 29.5 15.6193 22.531 15.2H22.5425Z" fill="currentColor" />
                            </svg>
                            <span>Nhân viên</span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="Notification.aspx" class="nav__link">
                            <svg width="24" height="26" viewBox="0 0 24 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5649 22.8437L12.5535 22.8456L12.4859 22.8789L12.4669 22.8827L12.4536 22.8789L12.3861 22.8446C12.3759 22.8421 12.3683 22.844 12.3633 22.8503L12.3595 22.8598L12.3433 23.2668L12.348 23.2859L12.3576 23.2982L12.4565 23.3686L12.4707 23.3724L12.4821 23.3686L12.581 23.2982L12.5925 23.283L12.5963 23.2668L12.5801 22.8608C12.5776 22.8506 12.5725 22.8449 12.5649 22.8437ZM12.8159 22.7362L12.8026 22.7381L12.6276 22.8265L12.6181 22.8361L12.6153 22.8465L12.6324 23.2554L12.6371 23.2668L12.6448 23.2745L12.8359 23.3619C12.8479 23.3651 12.8571 23.3626 12.8635 23.3543L12.8673 23.341L12.835 22.7571C12.8318 22.7451 12.8254 22.7381 12.8159 22.7362ZM12.136 22.7381C12.1318 22.7356 12.1268 22.7347 12.122 22.7358C12.1172 22.7369 12.113 22.7397 12.1103 22.7438L12.1046 22.7571L12.0723 23.341C12.0729 23.3524 12.0783 23.36 12.0884 23.3638L12.1027 23.3619L12.2938 23.2735L12.3034 23.2659L12.3062 23.2554L12.3233 22.8465L12.3205 22.8351L12.311 22.8256L12.136 22.7381Z" fill="#64748B" />
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.34315 9.28429C5.34315 7.51878 6.0445 5.82559 7.2929 4.57719C8.5413 3.32879 10.2345 2.62744 12 2.62744C13.7655 2.62744 15.4587 3.32879 16.7071 4.57719C17.9555 5.82559 18.6568 7.51878 18.6568 9.28429V12.8638L20.3895 16.3291C20.4693 16.4886 20.507 16.6659 20.4989 16.844C20.4909 17.0222 20.4375 17.1953 20.3437 17.347C20.25 17.4987 20.119 17.6239 19.9632 17.7107C19.8075 17.7976 19.6321 17.8431 19.4538 17.8431H15.6841C15.4726 18.6593 14.996 19.3821 14.3292 19.8981C13.6624 20.4141 12.8431 20.6941 12 20.6941C11.1569 20.6941 10.3376 20.4141 9.6708 19.8981C9.00401 19.3821 8.52744 18.6593 8.31591 17.8431H4.54623C4.3679 17.8431 4.19253 17.7976 4.03676 17.7107C3.881 17.6239 3.75001 17.4987 3.65625 17.347C3.56249 17.1953 3.50907 17.0222 3.50106 16.844C3.49304 16.6659 3.53071 16.4886 3.61047 16.3291L5.34315 12.8638V9.28429ZM10.3529 17.8431C10.5198 18.1322 10.7599 18.3723 11.0491 18.5392C11.3382 18.7061 11.6662 18.794 12 18.794C12.3338 18.794 12.6618 18.7061 12.9509 18.5392C13.2401 18.3723 13.4802 18.1322 13.6471 17.8431H10.3529ZM12 4.5294C10.7389 4.5294 9.5295 5.03036 8.63778 5.92207C7.74607 6.81379 7.24511 8.02321 7.24511 9.28429V12.8638C7.24509 13.1589 7.17639 13.45 7.04445 13.7139L5.93181 15.9411H18.0691L16.9565 13.7139C16.8242 13.45 16.7552 13.159 16.7549 12.8638V9.28429C16.7549 8.02321 16.2539 6.81379 15.3622 5.92207C14.4705 5.03036 13.2611 4.5294 12 4.5294Z" fill="currentColor" />
                            </svg>
                            <span>Thông báo</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="modal-overlay" id="deleteModalOverlay" style="display: none;">
            <div class="modal">
                <div class="icon-wrapper">
                    <svg class="alert-icon" width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.5 31.5L18 3L34.5 31.5H1.5ZM18 27C18.425 27 18.7815 26.856 19.0695 26.568C19.3575 26.28 19.501 25.924 19.5 25.5C19.499 25.076 19.355 24.72 19.068 24.432C18.781 24.144 18.425 24 18 24C17.575 24 17.219 24.144 16.932 24.432C16.645 24.72 16.501 25.076 16.5 25.5C16.499 25.924 16.643 26.2805 16.932 26.5695C17.221 26.8585 17.577 27.002 18 27ZM16.5 22.5H19.5V15H16.5V22.5Z" fill="#EC1313" />
                    </svg>

                </div>
                <h2>Xác nhận xóa nhân viên</h2>
                <p>Bạn có chắc chắn muốn xóa nhân viên này không? Hành động này sẽ đánh dấu nhân viên là "Đã xóa" và không thể hoàn tác trên giao diện.</p>
                <div class="button-group">
                    <button type="button" class="btn-modal btn-cancel" onclick="closeDeleteModal()">Hủy bỏ</button>
                    <button type="button" class="btn-modal btn-confirm" id="btnConfirmDelete" onclick="executeDelete()">Xác nhận xóa</button>
                </div>
            </div>
        </div>
    </form>
    <script type="text/javascript">
        // 1. Hàm mở Modal
        function openLogoutModal() {
            const modal = document.getElementById('modalOverlay');
            modal.style.display = 'flex';
        }

        // 2. Hàm đóng Modal
        function closeLogoutModal() {
            const modal = document.getElementById('modalOverlay');
            modal.style.display = 'none';
        }

        // 3. Hàm XÁC NHẬN ĐĂNG XUẤT 
        function confirmAction() {
            // Tạo một input ẩn tạm thời để gửi giá trị btnAction=logout lên Server
            const form = document.getElementById('form1');
            const old = form.querySelector('input[name="btnAction"]');
            if (old) old.remove();
            const hiddenField = document.createElement('input');
            hiddenField.type = 'hidden';
            hiddenField.name = 'btnAction';
            hiddenField.value = 'logout';

            form.appendChild(hiddenField);
            form.submit(); // Gửi form đi
        }

        // 4. Đóng khi click ra ngoài vùng trắng
        function closeModalOnOverlay(event) {
            if (event.target.id === 'modalOverlay') {
                closeLogoutModal();
            }
        }

        function toggleNotificationDropdown(e) {
            e.stopPropagation();
            document.getElementById('notificationDropdown').classList.toggle('show');
            document.getElementById('avatarMenu').classList.remove('show');
        }

        function toggleAvatarMenu(e) {
            if (window.innerWidth <= 768) {
                e.stopPropagation();
                document.getElementById('avatarMenu').classList.toggle('show');
                document.getElementById('notificationDropdown').classList.remove('show');
            }
        }

        // Đóng dropdown khi click bên ngoài
        document.addEventListener('click', function () {
            document.getElementById('notificationDropdown').classList.remove('show');
            document.getElementById('avatarMenu').classList.remove('show');
        });

        function handleToggle(userId, isChecked) {
            const form = document.getElementById('form1');

            // Xóa các hidden field toggle cũ nếu có
            const oldField = form.querySelector('input[name="toggleAction"]');
            if (oldField) oldField.remove();

            // Tạo hidden field chứa ID và trạng thái mới
            const hiddenField = document.createElement('input');
            hiddenField.type = 'hidden';
            hiddenField.name = 'toggleAction';
            hiddenField.value = userId + (isChecked ? ":1" : ":0");

            form.appendChild(hiddenField);
            form.submit();
        }

        let userIdToDelete = null;

        function openDeleteModal(id) {
            userIdToDelete = id;
            document.getElementById('deleteModalOverlay').style.display = 'flex';
        }

        function closeDeleteModal() {
            document.getElementById('deleteModalOverlay').style.display = 'none';
            userIdToDelete = null;
        }

        function executeDelete() {
            if (!userIdToDelete) return;

            const form = document.getElementById('form1');


            const oldAction = form.querySelector('input[name="btnAction"]');
            if (oldAction) oldAction.remove();
            const oldId = form.querySelector('input[name="deleteUserId"]');
            if (oldId) oldId.remove();

            // Tạo hidden field
            const actionField = document.createElement('input');
            actionField.type = 'hidden';
            actionField.name = 'btnAction';
            actionField.value = 'deleteUser';

            const idField = document.createElement('input');
            idField.type = 'hidden';
            idField.name = 'deleteUserId';
            idField.value = userIdToDelete;

            form.appendChild(actionField);
            form.appendChild(idField);

            // Gửi form lên Server
            form.submit();
        }
    </script>
</body>
</html>
